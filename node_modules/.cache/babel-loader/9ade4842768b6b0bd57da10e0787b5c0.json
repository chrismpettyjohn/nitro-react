{"ast":null,"code":"var _jsxFileName = \"/var/www/game.bobba.ca/src/components/avatar-editor/views/wardrobe/AvatarEditorWardrobeView.tsx\",\n    _s = $RefreshSig$();\n\nimport { SaveWardrobeOutfitMessageComposer } from '@nitrots/nitro-renderer';\nimport { useCallback, useMemo } from 'react';\nimport { GetAvatarRenderManager, GetClubMemberLevel, GetConfiguration, LocalizeText, SendMessageComposer } from '../../../../api';\nimport { AutoGrid, Base, Button, Flex, LayoutAvatarImageView, LayoutCurrencyIcon, LayoutGridItem } from '../../../../common';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AvatarEditorWardrobeView = props => {\n  _s();\n\n  const {\n    figureData = null,\n    savedFigures = [],\n    setSavedFigures = null,\n    loadAvatarInEditor = null\n  } = props;\n  const hcDisabled = GetConfiguration('hc.disabled', false);\n  const wearFigureAtIndex = useCallback(index => {\n    if (index >= savedFigures.length || index < 0) return;\n    const [figure, gender] = savedFigures[index];\n    loadAvatarInEditor(figure.getFigureString(), gender);\n  }, [savedFigures, loadAvatarInEditor]);\n  const saveFigureAtWardrobeIndex = useCallback(index => {\n    if (!figureData || index >= savedFigures.length || index < 0) return;\n    const newFigures = [...savedFigures];\n    const figure = figureData.getFigureString();\n    const gender = figureData.gender;\n    newFigures[index] = [GetAvatarRenderManager().createFigureContainer(figure), gender];\n    setSavedFigures(newFigures);\n    SendMessageComposer(new SaveWardrobeOutfitMessageComposer(index + 1, figure, gender));\n  }, [figureData, savedFigures, setSavedFigures]);\n  const figures = useMemo(() => {\n    if (!savedFigures || !savedFigures.length) return [];\n    const items = [];\n    savedFigures.forEach((_ref, index) => {\n      let [figureContainer, gender] = _ref;\n      let clubLevel = 0;\n      if (figureContainer) clubLevel = GetAvatarRenderManager().getFigureClubLevel(figureContainer, gender);\n      items.push( /*#__PURE__*/_jsxDEV(LayoutGridItem, {\n        position: \"relative\",\n        overflow: \"hidden\",\n        className: \"nitro-avatar-editor-wardrobe-figure-preview\",\n        children: [figureContainer && /*#__PURE__*/_jsxDEV(LayoutAvatarImageView, {\n          figure: figureContainer.getFigureString(),\n          gender: gender,\n          direction: 2\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Base, {\n          className: \"avatar-shadow\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 21\n        }, this), !hcDisabled && clubLevel > 0 && /*#__PURE__*/_jsxDEV(LayoutCurrencyIcon, {\n          className: \"position-absolute top-1 start-1\",\n          type: \"hc\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 57\n        }, this), /*#__PURE__*/_jsxDEV(Flex, {\n          gap: 1,\n          className: \"button-container\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            fullWidth: true,\n            onClick: event => saveFigureAtWardrobeIndex(index),\n            children: LocalizeText('avatareditor.wardrobe.save')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 25\n          }, this), figureContainer && /*#__PURE__*/_jsxDEV(Button, {\n            fullWidth: true,\n            onClick: event => wearFigureAtIndex(index),\n            disabled: clubLevel > GetClubMemberLevel(),\n            children: LocalizeText('generic_usable.button.use')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 66,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 21\n        }, this)]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 17\n      }, this));\n    });\n    return items;\n  }, [savedFigures, hcDisabled, saveFigureAtWardrobeIndex, wearFigureAtIndex]);\n  return /*#__PURE__*/_jsxDEV(AutoGrid, {\n    columnCount: 5,\n    columnMinWidth: 80,\n    columnMinHeight: 140,\n    children: figures\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 9\n  }, this);\n};\n\n_s(AvatarEditorWardrobeView, \"qo+Kxh12dmnebfqwxKEtAjcpZY0=\");\n\n_c = AvatarEditorWardrobeView;\n\nvar _c;\n\n$RefreshReg$(_c, \"AvatarEditorWardrobeView\");","map":{"version":3,"sources":["/var/www/game.bobba.ca/src/components/avatar-editor/views/wardrobe/AvatarEditorWardrobeView.tsx"],"names":["SaveWardrobeOutfitMessageComposer","useCallback","useMemo","GetAvatarRenderManager","GetClubMemberLevel","GetConfiguration","LocalizeText","SendMessageComposer","AutoGrid","Base","Button","Flex","LayoutAvatarImageView","LayoutCurrencyIcon","LayoutGridItem","AvatarEditorWardrobeView","props","figureData","savedFigures","setSavedFigures","loadAvatarInEditor","hcDisabled","wearFigureAtIndex","index","length","figure","gender","getFigureString","saveFigureAtWardrobeIndex","newFigures","createFigureContainer","figures","items","forEach","figureContainer","clubLevel","getFigureClubLevel","push","event"],"mappings":"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","sourcesContent":["import { IAvatarFigureContainer, SaveWardrobeOutfitMessageComposer } from '@nitrots/nitro-renderer';\nimport { Dispatch, FC, SetStateAction, useCallback, useMemo } from 'react';\nimport { GetAvatarRenderManager, GetClubMemberLevel, GetConfiguration, LocalizeText, SendMessageComposer } from '../../../../api';\nimport { AutoGrid, Base, Button, Flex, LayoutAvatarImageView, LayoutCurrencyIcon, LayoutGridItem } from '../../../../common';\nimport { FigureData } from '../../common/FigureData';\n\nexport interface AvatarEditorWardrobeViewProps\n{\n    figureData: FigureData;\n    savedFigures: [ IAvatarFigureContainer, string ][];\n    setSavedFigures: Dispatch<SetStateAction<[ IAvatarFigureContainer, string][]>>;\n    loadAvatarInEditor: (figure: string, gender: string, reset?: boolean) => void;\n}\n\nexport const AvatarEditorWardrobeView: FC<AvatarEditorWardrobeViewProps> = props =>\n{\n    const { figureData = null, savedFigures = [], setSavedFigures = null, loadAvatarInEditor = null } = props;\n\n    const hcDisabled = GetConfiguration<boolean>('hc.disabled', false);\n\n    const wearFigureAtIndex = useCallback((index: number) =>\n    {\n        if((index >= savedFigures.length) || (index < 0)) return;\n\n        const [ figure, gender ] = savedFigures[index];\n\n        loadAvatarInEditor(figure.getFigureString(), gender);\n    }, [ savedFigures, loadAvatarInEditor ]);\n\n    const saveFigureAtWardrobeIndex = useCallback((index: number) =>\n    {\n        if(!figureData || (index >= savedFigures.length) || (index < 0)) return;\n\n        const newFigures = [ ...savedFigures ];\n\n        const figure = figureData.getFigureString();\n        const gender = figureData.gender;\n\n        newFigures[index] = [ GetAvatarRenderManager().createFigureContainer(figure), gender ];\n\n        setSavedFigures(newFigures);\n        SendMessageComposer(new SaveWardrobeOutfitMessageComposer((index + 1), figure, gender));\n    }, [ figureData, savedFigures, setSavedFigures ]);\n\n    const figures = useMemo(() =>\n    {\n        if(!savedFigures || !savedFigures.length) return [];\n\n        const items: JSX.Element[] = [];\n\n        savedFigures.forEach(([ figureContainer, gender ], index) =>\n        {\n            let clubLevel = 0;\n\n            if(figureContainer) clubLevel = GetAvatarRenderManager().getFigureClubLevel(figureContainer, gender);\n\n            items.push(\n                <LayoutGridItem key={ index } position=\"relative\" overflow=\"hidden\" className=\"nitro-avatar-editor-wardrobe-figure-preview\">\n                    { figureContainer &&\n                    <LayoutAvatarImageView figure={ figureContainer.getFigureString() } gender={ gender } direction={ 2 } /> }\n                    <Base className=\"avatar-shadow\" />\n                    { !hcDisabled && (clubLevel > 0) && <LayoutCurrencyIcon className=\"position-absolute top-1 start-1\" type=\"hc\" /> }\n                    <Flex gap={ 1 } className=\"button-container\">\n                        <Button fullWidth onClick={ event => saveFigureAtWardrobeIndex(index) }>{ LocalizeText('avatareditor.wardrobe.save') }</Button>\n                        { figureContainer &&\n                        <Button fullWidth onClick={ event => wearFigureAtIndex(index) } disabled={ (clubLevel > GetClubMemberLevel()) }>{ LocalizeText('generic_usable.button.use') }</Button> }\n                    </Flex>\n                </LayoutGridItem>\n            );\n        });\n\n        return items;\n    }, [ savedFigures, hcDisabled, saveFigureAtWardrobeIndex, wearFigureAtIndex ]);\n\n    return (\n        <AutoGrid columnCount={ 5 } columnMinWidth={ 80 } columnMinHeight={ 140 }>\n            { figures }\n        </AutoGrid>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}