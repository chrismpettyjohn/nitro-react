{"ast":null,"code":"var _jsxFileName = \"/var/www/game.bobba.ca/src/components/inventory/views/pet/InventoryPetView.tsx\",\n    _s = $RefreshSig$();\n\nimport { RoomObjectVariable } from '@nitrots/nitro-renderer';\nimport { useEffect, useState } from 'react';\nimport { attemptPetPlacement, GetRoomEngine, LocalizeText, UnseenItemCategory } from '../../../../api';\nimport { AutoGrid, Button, Column, Grid, LayoutRoomPreviewerView, Text } from '../../../../common';\nimport { useInventoryPets, useInventoryUnseenTracker } from '../../../../hooks';\nimport { InventoryCategoryEmptyView } from '../InventoryCategoryEmptyView';\nimport { InventoryPetItemView } from './InventoryPetItemView';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const InventoryPetView = props => {\n  _s();\n\n  const {\n    roomSession = null,\n    roomPreviewer = null\n  } = props;\n  const [isVisible, setIsVisible] = useState(false);\n  const {\n    petItems = null,\n    selectedPet = null,\n    activate = null,\n    deactivate = null\n  } = useInventoryPets();\n  const {\n    isUnseen = null,\n    removeUnseen = null\n  } = useInventoryUnseenTracker();\n  useEffect(() => {\n    if (!selectedPet || !roomPreviewer) return;\n    const petData = selectedPet.petData;\n    const roomEngine = GetRoomEngine();\n    let wallType = roomEngine.getRoomInstanceVariable(roomEngine.activeRoomId, RoomObjectVariable.ROOM_WALL_TYPE);\n    let floorType = roomEngine.getRoomInstanceVariable(roomEngine.activeRoomId, RoomObjectVariable.ROOM_FLOOR_TYPE);\n    let landscapeType = roomEngine.getRoomInstanceVariable(roomEngine.activeRoomId, RoomObjectVariable.ROOM_LANDSCAPE_TYPE);\n    wallType = wallType && wallType.length ? wallType : '101';\n    floorType = floorType && floorType.length ? floorType : '101';\n    landscapeType = landscapeType && landscapeType.length ? landscapeType : '1.1';\n    roomPreviewer.reset(false);\n    roomPreviewer.updateRoomWallsAndFloorVisibility(true, true);\n    roomPreviewer.updateObjectRoom(floorType, wallType, landscapeType);\n    roomPreviewer.addPetIntoRoom(petData.figureString);\n  }, [roomPreviewer, selectedPet]);\n  useEffect(() => {\n    if (!selectedPet || !isUnseen(UnseenItemCategory.PET, selectedPet.petData.id)) return;\n    removeUnseen(UnseenItemCategory.PET, selectedPet.petData.id);\n  }, [selectedPet, isUnseen, removeUnseen]);\n  useEffect(() => {\n    if (!isVisible) return;\n    const id = activate();\n    return () => deactivate(id);\n  }, [isVisible, activate, deactivate]);\n  useEffect(() => {\n    setIsVisible(true);\n    return () => setIsVisible(false);\n  }, []);\n  if (!petItems || !petItems.length) return /*#__PURE__*/_jsxDEV(InventoryCategoryEmptyView, {\n    title: LocalizeText('inventory.empty.pets.title'),\n    desc: LocalizeText('inventory.empty.pets.desc')\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 46\n  }, this);\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    children: [/*#__PURE__*/_jsxDEV(Column, {\n      size: 7,\n      overflow: \"hidden\",\n      children: /*#__PURE__*/_jsxDEV(AutoGrid, {\n        columnCount: 5,\n        children: petItems && petItems.length > 0 && petItems.map(item => /*#__PURE__*/_jsxDEV(InventoryPetItemView, {\n          petItem: item\n        }, item.petData.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 81\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Column, {\n      size: 5,\n      overflow: \"auto\",\n      children: [/*#__PURE__*/_jsxDEV(Column, {\n        overflow: \"hidden\",\n        position: \"relative\",\n        children: /*#__PURE__*/_jsxDEV(LayoutRoomPreviewerView, {\n          roomPreviewer: roomPreviewer,\n          height: 140\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }, this), selectedPet && selectedPet.petData && /*#__PURE__*/_jsxDEV(Column, {\n        grow: true,\n        justifyContent: \"between\",\n        gap: 2,\n        children: [/*#__PURE__*/_jsxDEV(Text, {\n          grow: true,\n          truncate: true,\n          children: selectedPet.petData.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 25\n        }, this), !!roomSession && /*#__PURE__*/_jsxDEV(Button, {\n          onClick: event => attemptPetPlacement(selectedPet),\n          children: LocalizeText('inventory.furni.placetoroom')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 9\n  }, this);\n};\n\n_s(InventoryPetView, \"0Si8Ar/ue5CQESnFqqnijiJ633k=\", false, function () {\n  return [useInventoryPets, useInventoryUnseenTracker];\n});\n\n_c = InventoryPetView;\n\nvar _c;\n\n$RefreshReg$(_c, \"InventoryPetView\");","map":{"version":3,"sources":["/var/www/game.bobba.ca/src/components/inventory/views/pet/InventoryPetView.tsx"],"names":["RoomObjectVariable","useEffect","useState","attemptPetPlacement","GetRoomEngine","LocalizeText","UnseenItemCategory","AutoGrid","Button","Column","Grid","LayoutRoomPreviewerView","Text","useInventoryPets","useInventoryUnseenTracker","InventoryCategoryEmptyView","InventoryPetItemView","InventoryPetView","props","roomSession","roomPreviewer","isVisible","setIsVisible","petItems","selectedPet","activate","deactivate","isUnseen","removeUnseen","petData","roomEngine","wallType","getRoomInstanceVariable","activeRoomId","ROOM_WALL_TYPE","floorType","ROOM_FLOOR_TYPE","landscapeType","ROOM_LANDSCAPE_TYPE","length","reset","updateRoomWallsAndFloorVisibility","updateObjectRoom","addPetIntoRoom","figureString","PET","id","map","item","name","event"],"mappings":"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","sourcesContent":["import { IRoomSession, RoomObjectVariable, RoomPreviewer } from '@nitrots/nitro-renderer';\nimport { FC, useEffect, useState } from 'react';\nimport { attemptPetPlacement, GetRoomEngine, LocalizeText, UnseenItemCategory } from '../../../../api';\nimport { AutoGrid, Button, Column, Grid, LayoutRoomPreviewerView, Text } from '../../../../common';\nimport { useInventoryPets, useInventoryUnseenTracker } from '../../../../hooks';\nimport { InventoryCategoryEmptyView } from '../InventoryCategoryEmptyView';\nimport { InventoryPetItemView } from './InventoryPetItemView';\n\ninterface InventoryPetViewProps\n{\n    roomSession: IRoomSession;\n    roomPreviewer: RoomPreviewer;\n}\n\nexport const InventoryPetView: FC<InventoryPetViewProps> = props =>\n{\n    const { roomSession = null, roomPreviewer = null } = props;\n    const [ isVisible, setIsVisible ] = useState(false);\n    const { petItems = null, selectedPet = null, activate = null, deactivate = null } = useInventoryPets();\n    const { isUnseen = null, removeUnseen = null } = useInventoryUnseenTracker();\n\n    useEffect(() =>\n    {\n        if(!selectedPet || !roomPreviewer) return;\n\n        const petData = selectedPet.petData;\n        const roomEngine = GetRoomEngine();\n\n        let wallType = roomEngine.getRoomInstanceVariable<string>(roomEngine.activeRoomId, RoomObjectVariable.ROOM_WALL_TYPE);\n        let floorType = roomEngine.getRoomInstanceVariable<string>(roomEngine.activeRoomId, RoomObjectVariable.ROOM_FLOOR_TYPE);\n        let landscapeType = roomEngine.getRoomInstanceVariable<string>(roomEngine.activeRoomId, RoomObjectVariable.ROOM_LANDSCAPE_TYPE);\n\n        wallType = (wallType && wallType.length) ? wallType : '101';\n        floorType = (floorType && floorType.length) ? floorType : '101';\n        landscapeType = (landscapeType && landscapeType.length) ? landscapeType : '1.1';\n\n        roomPreviewer.reset(false);\n        roomPreviewer.updateRoomWallsAndFloorVisibility(true, true);\n        roomPreviewer.updateObjectRoom(floorType, wallType, landscapeType);\n        roomPreviewer.addPetIntoRoom(petData.figureString);\n    }, [ roomPreviewer, selectedPet ]);\n\n    useEffect(() =>\n    {\n        if(!selectedPet || !isUnseen(UnseenItemCategory.PET, selectedPet.petData.id)) return;\n\n        removeUnseen(UnseenItemCategory.PET, selectedPet.petData.id);\n    }, [ selectedPet, isUnseen, removeUnseen ]);\n\n    useEffect(() =>\n    {\n        if(!isVisible) return;\n\n        const id = activate();\n\n        return () => deactivate(id);\n    }, [ isVisible, activate, deactivate ]);\n\n    useEffect(() =>\n    {\n        setIsVisible(true);\n\n        return () => setIsVisible(false);\n    }, []);\n\n    if(!petItems || !petItems.length) return <InventoryCategoryEmptyView title={ LocalizeText('inventory.empty.pets.title') } desc={ LocalizeText('inventory.empty.pets.desc') } />;\n\n    return (\n        <Grid>\n            <Column size={ 7 } overflow=\"hidden\">\n                <AutoGrid columnCount={ 5 }>\n                    { petItems && (petItems.length > 0) && petItems.map(item => <InventoryPetItemView key={ item.petData.id } petItem={ item } />) }\n                </AutoGrid>\n            </Column>\n            <Column size={ 5 } overflow=\"auto\">\n                <Column overflow=\"hidden\" position=\"relative\">\n                    <LayoutRoomPreviewerView roomPreviewer={ roomPreviewer } height={ 140 } />\n                </Column>\n                { selectedPet && selectedPet.petData &&\n                    <Column grow justifyContent=\"between\" gap={ 2 }>\n                        <Text grow truncate>{ selectedPet.petData.name }</Text>\n                        { !!roomSession &&\n                            <Button onClick={ event => attemptPetPlacement(selectedPet) }>\n                                { LocalizeText('inventory.furni.placetoroom') }\n                            </Button> }\n                    </Column> }\n            </Column>\n        </Grid>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}